\section{Análisis teórico}
En esta sección realizamos un análsis teórico sobre la performance de los diferentes estimadores para tipos de distribuciones variados.

\subsection{Performance en distribuciones uniformes}
Para responder la pregunta de qué estimador debe exhibir mejor performance en un dataset con distribución uniforme, hace falta primero analizar con detenimiento este tipo de distribución. La distribución uniforme ``reparte'' los elementos en el rango disponible de forma equitativa: todos los enteros tienen la misma probabilidad de ocurrir.

Es decir, la forma de un Histograma Clásico de la distribución tendrá todas las barras del mismo ancho (por invariante de construcción del histograma) y de la misma altura, pues todos los rangos de idéntico ancho tienen aproximadamente la misma cantidad de elementos.

A su vez, la forma de un histograma de Distribution Steps tendrá todas las barras de la misma altura (por invariante de construcción del histograma) y del mismo ancho, pues la cantidad de elementos que resulta ser menor a un cierto porcentaje de los demás está relacionado directamente con ese porcentaje. Dicho en otras palabras, suponiendo un histograma de 10 barras, las barras tendrán un ancho aproximado al 10\% del rango de la distribución, pues eso mantiene la condición (de Distribution Steps) de que el límite derecho de la barra i deja a su izquierda 10i\% de los elementos (ver la sección de Estimadores para más información).

Entonces concluimos que, para un mismo parámetro (cantidad de barras) ambas distribuciones ``dibujarán'' prácticamente el mismo histograma. Esto podría inducir a pensar que la respuesta podría ser similar y que por lo tanto la performance será la misma, pero estaríamos olvidando que ``usan'' esos histogramas de maneras distintas.

Para las consultas por igualdad el Histograma Clásico computa la probabilidad dividiendo la altura de la barra en la que cae el número consultado por la cantidad de elementos totales. De este modo, si la cantidad de barras es 20, una distribución uniforme producirá una respuesta del 5\% (todas las barras tienen altura aproximadamente igual a 5\% del total). Sin embargo, si el rango es lo suficientemente grande, 5\% difícilmente sea una buena estimación (en particular para un rango con más de 20 elementos cae por arriba de la probabilidad real). Concluimos entonces que la performance del Histograma Clásico será mejor cuanto más cercano sea el parámetro a la extensión del rango, pero de ser muy distintos estos valores (y en general lo son) puede provocar un error grande.

Por otro lado, el método de Distribution Steps (en su versión que minimiza el error en el caso promedio, que es la elegimos implementar) computa en el momento de su construcción el $\delta$ y responde basándose en ese valor. En particular en el caso más probable para una distribución uniforme (que el valor consultado coincida con uno o cero límites entre barras, y no con uno extremo) el estimador responde exactamente ese $\delta$. Es decir, antes que nada, que su performance difícilmente dependa de la cantidad de barras (su parámetro). Veamos si ese $\delta$ es una buena estimación en el caso de una distribución uniforme.

$\delta$ es el mínimo entre $0.5/S$ y la densidad, donde $S$ es el parámetro (la cantidad de barras) y la densidad es la medida de la que ya hablamos en la sección de estimadores. Como ya dijimos, para valores razonables (no muy grandes) de $S$ es muy probable que la densidad sea menor a $0.5/S$, por lo cual en general caeremos en el caso $\delta = $ densidad. Como la densidad, informalmente hablando, es el porcentaje promedio de valores iguales, en el caso de una distribución uniforme será muy cercana a $1$ dividido la cantidad de elementos distintos (que es exactamente la probabilidad de que un elemento de una distribución uniforme sea igual a un $x_0$ cualquiera). Por esto concluimos que independientemente del parámetro elegido, Distribution Steps estimará bien la selectividad por igualdad en una distribución uniforme.

El caso de la estimación por mayor funciona distinto. En este caso, el método de Distribution Steps sí utiliza la información del histograma.


En esta situación tanto el estimador basado en Histograma Clásico como el basado en Distribution Steps deberían exhibir la misma performance cuando son construidos con los mismos parámetros (cantidad de buckets y cantidad de steps respectivamente). Esto se debe, esencialmente, a que en el histograma de un distribución uniforme la cantidad de elementos que caen en cada bucket es, en términos probabilísticos, la misma. Esto quiere decir que los buckets no solo comparten la longitud sino que, en este caso, tienen la misma altura. Los steps del segundo estimador están distribuidos de tal manera que en cada intervalo se encuentra la misma cantidad de elementos, pero entonces por lo que vimos anteriormente, en el caso de la distribución uniforme coinciden con los buckets del histograma. Por lo tanto los estimadores no son significativamente diferentes.